<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Support a Custom Data Model • ReviewR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Support a Custom Data Model">
<meta property="og:description" content="ReviewR">
<meta property="og:image" content="reviewr.thewileylab.org/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ReviewR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Deploying ReviewR
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/deploy-local.html">Local Deployment</a>
    </li>
    <li>
      <a href="../articles/deploy-server.html">Shiny Server Deployment</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Using ReviewR
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/connect_to_patient_records.html">Connect to Patient Record Database</a>
    </li>
    <li>
      <a href="../articles/connect_to_redcap.html">Connect to REDCap</a>
    </li>
    <li>
      <a href="../articles/perform_a_chart_review.html">Perform A Chart Review</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Customizing ReviewR
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/support_a_new_relational_database_management_system.html">Support a New Relational Database Management System</a>
    </li>
    <li>
      <a href="../articles/support_a_custom_data_model.html">Support a Custom Datamodel</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/connect_to_patient_records.html">Connect to Patient Record Database</a>
    </li>
    <li>
      <a href="../articles/connect_to_redcap.html">Connect to REDCap</a>
    </li>
    <li>
      <a href="../articles/deploy-local.html">Local Deployment</a>
    </li>
    <li>
      <a href="../articles/deploy-server.html">Shiny Server Deployment</a>
    </li>
    <li>
      <a href="../articles/perform_a_chart_review.html">Perform A Chart Review</a>
    </li>
    <li>
      <a href="../articles/support_a_custom_data_model.html">Support a Custom Data Model</a>
    </li>
    <li>
      <a href="../articles/support_a_new_relational_database_management_system.html">Support a New Relational Database Management System</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="https://github.com/thewileylab/ReviewR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="support_a_custom_data_model_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="support_a_custom_data_model_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="support_a_custom_data_model_files/anchor-sections-1.0/anchor-sections.js"></script><script src="support_a_custom_data_model_files/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="support_a_custom_data_model_files/jquery-1.12.4/jquery.min.js"></script><link href="support_a_custom_data_model_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="support_a_custom_data_model_files/datatables-binding-0.16/datatables.js"></script><link href="support_a_custom_data_model_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="support_a_custom_data_model_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="support_a_custom_data_model_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="support_a_custom_data_model_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="support_a_custom_data_model_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Support a Custom Data Model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/thewileylab/ReviewR/blob/master/vignettes/support_a_custom_data_model.Rmd"><code>vignettes/support_a_custom_data_model.Rmd</code></a></small>
      <div class="hidden name"><code>support_a_custom_data_model.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>Currently, ReviewR is capable of displaying patient information from databases that conform to the MIMIC-III and OMOP data models. However, we recognize that no two EHR’s are exactly the same and patient data can be stored in a variety of different formats. Armed with a little bit of knowledge about your patient information database, ReviewR can be extended to display patient data for additional data models.</p>
<div id="requirements" class="section level3">
<h3 class="hasAnchor">
<a href="#requirements" class="anchor"></a>Requirements</h3>
<p>In order for ReviewR to display patient data stored in other data models, ReviewR requires two things:</p>
<ol style="list-style-type: decimal">
<li>Data model <a href="#table-functions">table functions</a> must be developed to display the detected patient data model
<ul>
<li>Must follow the table function <a href="#table-function-naming-convention">naming convention</a>
</li>
</ul>
</li>
<li>ReviewR must be able to identify the patient data model of the connected database</li>
</ol>
<p>These requirements will be discussed in the sections that follow.</p>
</div>
<div id="table-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#table-functions" class="anchor"></a>Table Functions</h3>
<p>Displaying patient data from other data models is made possible by developing <em>table functions</em> which are incorporated into the ReviewR package namespace. Once ReviewR has determined data model and version of the user database, it will search within its namespace for table functions that can be used to render the information contained within the connected data model.</p>
<div id="table-function-naming-convention" class="section level4">
<h4 class="hasAnchor">
<a href="#table-function-naming-convention" class="anchor"></a>Table Function Naming Convention</h4>
<p>Table functions have a standard naming convention, which allows for them to be associated with the currently detected data model. Functions used to render patient tables must begin with <code>{data-model-name}_table_</code> and will end with the <em>name</em> of the table you would like to display. Once table functions have been created for a data model, all functions that have been developed will displayed as tabs in the Chart Review section of ReviewR when the new data model is detected.</p>
<p>In the example that follows, the “Admissions” table from the “mimic3” data model is selected on the Chart Review Section of ReviewR. The function responsible for creating this tab is called: <code>mimic3_table_admissions</code>. As you can see, the <em>name</em> portion of the function (“admissions”) has become the tab name for this patient table:</p>
<div class="figure" style="text-align: center">
<img src="chart_review_tabs.png" alt="*Patient information tabs in the Chart Review Section of ReviewR generated by table functions.*" width="1071"><p class="caption">
<em>Patient information tabs in the Chart Review Section of ReviewR generated by table functions.</em>
</p>
</div>
<p>Other patient information tables that have been developed for the “mimic3” data model appear on the inactive Chart Review tabs. Each function begins with <code>mimic3_table_</code>, per the table function naming convention.      </p>
<p>Two types of table functions must be developed when supporting a new data model, an “All Patients” table and “Subject Specific” tables. Information about developing these function types may be obtained from the <a href="#adding-support-for-a-new-data-model">Adding Support for a New Data Model</a> section below.</p>
</div>
</div>
<div id="data-model-detection" class="section level3">
<h3 class="hasAnchor">
<a href="#data-model-detection" class="anchor"></a>Data Model Detection</h3>
<p>Using the connection information supplied by a database connection module, ReviewR will interrogate a user database and attempt to determine the data model and data model version. ReviewR does this by discovering the table and field names of the connected database and compares them with the data model specifications that have been built into the package. The data model that has the most matching tables/field combinations will be identified as the currently connected data model. This will enable ReviewR to locate table functions that have been built into the package that correspond to the detected data model.</p>
<p>To see a list of available database specifications in ReviewR, run:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://reviewr.thewileylab.org/">ReviewR</a></span><span class="op">)</span>
<span class="fu">ReviewR</span><span class="fu">::</span><span class="va"><a href="../reference/supported_datamodels.html">supported_datamodels</a></span>
<span class="co">#&gt; # A tibble: 12 x 4</span>
<span class="co">#&gt; # Groups:   file_path, datamodel, model_version [12]</span>
<span class="co">#&gt;    datamodel model_version data             file_path                           </span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;         &lt;list&gt;           &lt;chr&gt;                               </span>
<span class="co">#&gt;  1 mimic3    "v1.4"        &lt;tibble [332 × … data-raw/datamodels/mimic3_v1.4.csv </span>
<span class="co">#&gt;  2 mimic3    ""            &lt;tibble [333 × … data-raw/datamodels/mimic3.csv      </span>
<span class="co">#&gt;  3 omop      "v4"          &lt;tibble [49 × 8… data-raw/datamodels/omop_v4.csv     </span>
<span class="co">#&gt;  4 omop      "v5.0.1"      &lt;tibble [328 × … data-raw/datamodels/omop_v5.0.1.csv </span>
<span class="co">#&gt;  5 omop      "v5.1.0"      &lt;tibble [339 × … data-raw/datamodels/omop_v5.1.0.csv </span>
<span class="co">#&gt;  6 omop      "v5.1.1"      &lt;tibble [339 × … data-raw/datamodels/omop_v5.1.1.csv </span>
<span class="co">#&gt;  7 omop      "v5.2"        &lt;tibble [365 × … data-raw/datamodels/omop_v5.2_bugfi…</span>
<span class="co">#&gt;  8 omop      "v5.2.0"      &lt;tibble [334 × … data-raw/datamodels/omop_v5.2.0.csv </span>
<span class="co">#&gt;  9 omop      "v5.2.2"      &lt;tibble [363 × … data-raw/datamodels/omop_v5.2.2.csv </span>
<span class="co">#&gt; 10 omop      "v5.3.0"      &lt;tibble [407 × … data-raw/datamodels/omop_v5.3.0.csv </span>
<span class="co">#&gt; 11 omop      "v5.3.1"      &lt;tibble [407 × … data-raw/datamodels/omop_v5.3.1.csv </span>
<span class="co">#&gt; 12 omop      "v6.0"        &lt;tibble [427 × … data-raw/datamodels/omop_v6.0.csv</span></pre></div>
<p>A data frame with 4 columns will be returned:</p>
<ul>
<li>datamodel: The data model name</li>
<li>model_version: The data model version</li>
<li>data: A nested data frame with the schema of the data model itself
<ul>
<li>This schema information comes from CSV files that may be built into the ReviewR package</li>
</ul>
</li>
<li>file_path: The file path<a href="#file-path">*</a> of the data source</li>
</ul>
<div id="schema-files" class="section level4">
<h4 class="hasAnchor">
<a href="#schema-files" class="anchor"></a>Schema Files</h4>
<p>If you would like to add a data model to the database detection for ReviewR, you will need a schema file. Schema files must contain two columns, called <code>table</code> and <code>field</code>, which identify every field for every table in the data model and must be comma separated values (CSV) delimited. They are often available from the developer of the data model. If obtained from a developer, these files may include additional information beyond the required table and field designations. These files may still be used, but additional descriptors will be ignored. The schema file for the OMOP CDM v5.3.0 is provided as an example:</p>
<div class="figure" style="text-align: center">
<div id="htmlwidget-a920ea82bf9befb8f8b9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a920ea82bf9befb8f8b9">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407"],["concept","concept","concept","concept","concept","concept","concept","concept","concept","concept","vocabulary","vocabulary","vocabulary","vocabulary","vocabulary","domain","domain","domain","concept_class","concept_class","concept_class","concept_relationship","concept_relationship","concept_relationship","concept_relationship","concept_relationship","concept_relationship","relationship","relationship","relationship","relationship","relationship","relationship","concept_synonym","concept_synonym","concept_synonym","concept_ancestor","concept_ancestor","concept_ancestor","concept_ancestor","source_to_concept_map","source_to_concept_map","source_to_concept_map","source_to_concept_map","source_to_concept_map","source_to_concept_map","source_to_concept_map","source_to_concept_map","source_to_concept_map","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","cohort_definition","cohort_definition","cohort_definition","cohort_definition","cohort_definition","cohort_definition","cohort_definition","attribute_definition","attribute_definition","attribute_definition","attribute_definition","attribute_definition","cdm_source","cdm_source","cdm_source","cdm_source","cdm_source","cdm_source","cdm_source","cdm_source","cdm_source","cdm_source","metadata","metadata","metadata","metadata","metadata","metadata","metadata","person","person","person","person","person","person","person","person","person","person","person","person","person","person","person","person","person","person","observation_period","observation_period","observation_period","observation_period","observation_period","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","death","death","death","death","death","death","death","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","note","note","note","note","note","note","note","note","note","note","note","note","note","note","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","fact_relationship","fact_relationship","fact_relationship","fact_relationship","fact_relationship","location","location","location","location","location","location","location","location","care_site","care_site","care_site","care_site","care_site","care_site","provider","provider","provider","provider","provider","provider","provider","provider","provider","provider","provider","provider","provider","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cohort","cohort","cohort","cohort","cohort_attribute","cohort_attribute","cohort_attribute","cohort_attribute","cohort_attribute","cohort_attribute","cohort_attribute","drug_era","drug_era","drug_era","drug_era","drug_era","drug_era","drug_era","dose_era","dose_era","dose_era","dose_era","dose_era","dose_era","dose_era","condition_era","condition_era","condition_era","condition_era","condition_era","condition_era"],["concept_id","concept_name","domain_id","vocabulary_id","concept_class_id","standard_concept","concept_code","valid_start_date","valid_end_date","invalid_reason","vocabulary_id","vocabulary_name","vocabulary_reference","vocabulary_version","vocabulary_concept_id","domain_id","domain_name","domain_concept_id","concept_class_id","concept_class_name","concept_class_concept_id","concept_id_1","concept_id_2","relationship_id","valid_start_date","valid_end_date","invalid_reason","relationship_id","relationship_name","is_hierarchical","defines_ancestry","reverse_relationship_id","relationship_concept_id","concept_id","concept_synonym_name","language_concept_id","ancestor_concept_id","descendant_concept_id","min_levels_of_separation","max_levels_of_separation","source_code","source_concept_id","source_vocabulary_id","source_code_description","target_concept_id","target_vocabulary_id","valid_start_date","valid_end_date","invalid_reason","drug_concept_id","ingredient_concept_id","amount_value","amount_unit_concept_id","numerator_value","numerator_unit_concept_id","denominator_value","denominator_unit_concept_id","box_size","valid_start_date","valid_end_date","invalid_reason","cohort_definition_id","cohort_definition_name","cohort_definition_description","definition_type_concept_id","cohort_definition_syntax","subject_concept_id","cohort_initiation_date","attribute_definition_id","attribute_name","attribute_description","attribute_type_concept_id","attribute_syntax","cdm_source_name","cdm_source_abbreviation","cdm_holder","source_description","source_documentation_reference","cdm_etl_reference","source_release_date","cdm_release_date","cdm_version","vocabulary_version","metadata_concept_id","metadata_type_concept_id","name","value_as_string","value_as_concept_id","metadata_date","metadata_datetime","person_id","gender_concept_id","year_of_birth","month_of_birth","day_of_birth","birth_datetime","race_concept_id","ethnicity_concept_id","location_id","provider_id","care_site_id","person_source_value","gender_source_value","gender_source_concept_id","race_source_value","race_source_concept_id","ethnicity_source_value","ethnicity_source_concept_id","observation_period_id","person_id","observation_period_start_date","observation_period_end_date","period_type_concept_id","specimen_id","person_id","specimen_concept_id","specimen_type_concept_id","specimen_date","specimen_datetime","quantity","unit_concept_id","anatomic_site_concept_id","disease_status_concept_id","specimen_source_id","specimen_source_value","unit_source_value","anatomic_site_source_value","disease_status_source_value","person_id","death_date","death_datetime","death_type_concept_id","cause_concept_id","cause_source_value","cause_source_concept_id","visit_occurrence_id","person_id","visit_concept_id","visit_start_date","visit_start_datetime","visit_end_date","visit_end_datetime","visit_type_concept_id","provider_id","care_site_id","visit_source_value","visit_source_concept_id","admitting_source_concept_id","admitting_source_value","discharge_to_concept_id","discharge_to_source_value","preceding_visit_occurrence_id","visit_detail_id","person_id","visit_detail_concept_id","visit_start_date","visit_start_datetime","visit_end_date","visit_end_datetime","visit_type_concept_id","provider_id","care_site_id","admitting_source_concept_id","discharge_to_concept_id","preceding_visit_detail_id","visit_source_value","visit_source_concept_id","admitting_source_value","discharge_to_source_value","visit_detail_parent_id","visit_occurrence_id","procedure_occurrence_id","person_id","procedure_concept_id","procedure_date","procedure_datetime","procedure_type_concept_id","modifier_concept_id","quantity","provider_id","visit_occurrence_id","visit_detail_id","procedure_source_value","procedure_source_concept_id","modifier_source_value","drug_exposure_id","person_id","drug_concept_id","drug_exposure_start_date","drug_exposure_start_datetime","drug_exposure_end_date","drug_exposure_end_datetime","verbatim_end_date","drug_type_concept_id","stop_reason","refills","quantity","days_supply","sig","route_concept_id","lot_number","provider_id","visit_occurrence_id","visit_detail_id","drug_source_value","drug_source_concept_id","route_source_value","dose_unit_source_value","device_exposure_id","person_id","device_concept_id","device_exposure_start_date","device_exposure_start_datetime","device_exposure_end_date","device_exposure_end_datetime","device_type_concept_id","unique_device_id","quantity","provider_id","visit_occurrence_id","visit_detail_id","device_source_value","device_source_concept_id","condition_occurrence_id","person_id","condition_concept_id","condition_start_date","condition_start_datetime","condition_end_date","condition_end_datetime","condition_type_concept_id","stop_reason","provider_id","visit_occurrence_id","visit_detail_id","condition_source_value","condition_source_concept_id","condition_status_source_value","condition_status_concept_id","measurement_id","person_id","measurement_concept_id","measurement_date","measurement_time","measurement_datetime","measurement_type_concept_id","operator_concept_id","value_as_number","value_as_concept_id","unit_concept_id","range_low","range_high","provider_id","visit_occurrence_id","visit_detail_id","measurement_source_value","measurement_source_concept_id","unit_source_value","value_source_value","note_id","person_id","note_date","note_datetime","note_type_concept_id","note_class_concept_id","note_title","note_text","encoding_concept_id","language_concept_id","provider_id","visit_occurrence_id","visit_detail_id","note_source_value","note_nlp_id","note_id","section_concept_id","snippet","offset","lexical_variant","note_nlp_concept_id","note_nlp_source_concept_id","nlp_system","nlp_date","nlp_datetime","term_exists","term_temporal","term_modifiers","observation_id","person_id","observation_concept_id","observation_date","observation_datetime","observation_type_concept_id","value_as_number","value_as_string","value_as_concept_id","qualifier_concept_id","unit_concept_id","provider_id","visit_occurrence_id","visit_detail_id","observation_source_value","observation_source_concept_id","unit_source_value","qualifier_source_value","domain_concept_id_1","fact_id_1","domain_concept_id_2","fact_id_2","relationship_concept_id","location_id","address_1","address_2","city","state","zip","county","location_source_value","care_site_id","care_site_name","place_of_service_concept_id","location_id","care_site_source_value","place_of_service_source_value","provider_id","provider_name","npi","dea","specialty_concept_id","care_site_id","year_of_birth","gender_concept_id","provider_source_value","specialty_source_value","specialty_source_concept_id","gender_source_value","gender_source_concept_id","payer_plan_period_id","person_id","payer_plan_period_start_date","payer_plan_period_end_date","payer_concept_id","payer_source_value","payer_source_concept_id","plan_concept_id","plan_source_value","plan_source_concept_id","sponsor_concept_id","sponsor_source_value","sponsor_source_concept_id","family_source_value","stop_reason_concept_id","stop_reason_source_value","stop_reason_source_concept_id","cost_id","cost_event_id","cost_domain_id","cost_type_concept_id","currency_concept_id","total_charge","total_cost","total_paid","paid_by_payer","paid_by_patient","paid_patient_copay","paid_patient_coinsurance","paid_patient_deductible","paid_by_primary","paid_ingredient_cost","paid_dispensing_fee","payer_plan_period_id","amount_allowed","revenue_code_concept_id","reveue_code_source_value","drg_concept_id","drg_source_value","cohort_definition_id","subject_id","cohort_start_date","cohort_end_date","cohort_definition_id","subject_id","cohort_start_date","cohort_end_date","attribute_definition_id","value_as_number","value_as_concept_id","drug_era_id","person_id","drug_concept_id","drug_era_start_date","drug_era_end_date","drug_exposure_count","gap_days","dose_era_id","person_id","drug_concept_id","unit_concept_id","dose_value","dose_era_start_date","dose_era_end_date","condition_era_id","person_id","condition_concept_id","condition_era_start_date","condition_era_end_date","condition_occurrence_count"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>table<\/th>\n      <th>field<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script><p class="caption">
<em>Table 1: OMOP v5.3.0 Schema obtained from <a href="https://github.com/OHDSI/CommonDataModel/releases/tag/v5.3.0">OHDSI</a></em>
</p>
</div>
<p>See the <a href="#adding-support-for-a-custom-data-model">Adding Support for a Custom Data Model</a> section for information on how to build additional schema information into ReviewR so that the built in data model detection can identify the patient data model you are adding support for.</p>
<hr>
<p><a name="file-path"></a> *<em>Note: The data-raw file path is only available when forking the ReviewR repository from GitHub.</em></p>
</div>
</div>
</div>
<div id="adding-support-for-a-custom-data-model" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-support-for-a-custom-data-model" class="anchor"></a>Adding Support for a Custom Data Model</h2>
<p>A convenience function has been built into ReviewR to assist in supporting additional data models, <code><a href="../reference/dev_add_datamodel.html">dev_add_datamodel()</a></code>. This function will add a CSV file containing schema information into the data model detection module within ReviewR. When run, it will prompt the user to identify the “all patients” table and which field contains the patient identifier (<code>subject_id</code>) information. Additionally, it will create a .R file with skeleton table functions for all tables identified within the supplied CSV file. Separate all patients and subject filtered functions will be created, with templated code to assist in filtering the subject table information down to the selected subject.</p>
<p>This allows for a developer to customize the representation for each table in the data model they wish to support. It is important to note that the <code><a href="../reference/dev_add_datamodel.html">dev_add_datamodel()</a></code> function will create a skeleton function for <em>every</em> table contained within your schema CSV file. This is often not appropriate for relational databases, as certain tables may not contain actual patient information, but rather hold information about data stored in other tables. When developing, be aware of these relationships so that joins can be made on the appropriate tables to show the display the information properly. Tables which contain relational information need not be displayed on the Chart Review Tab, and the table function skeletons created by the dev function may safely be omitted.</p>
<div id="getting-started" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting Started</h3>
<p>To ensure you have access to the latest development tools and file structure of the ReviewR package, fork ReviewR from GitHub. For simplicity, the home directory is specified as a destination directory:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># install.packages('usethis')</span>
<span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/create_from_github.html">create_from_github</a></span><span class="op">(</span>repo_spec <span class="op">=</span> <span class="st">'thewileylab/ReviewR'</span>, destdir <span class="op">=</span> <span class="st">'~/'</span><span class="op">)</span></pre></div>
<p>Please see <a href="https://happygitwithr.com/index.html">this guide</a> if you have trouble connecting RStudio with Git. It is also possible to fork this repo directly from GitHub if all else fails.</p>
<p>Navigate to the forked repository and open the <code>ReviewR.Rproj</code> file. This will open the project in RStudio. Finally, using the devtools package run:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="co"># install.packages('devtools')</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/load_all.html">load_all</a></span><span class="op">(</span><span class="op">)</span></pre></div>
</div>
<div id="developingtesting" class="section level3">
<h3 class="hasAnchor">
<a href="#developingtesting" class="anchor"></a>Developing/Testing</h3>
<p>Develop your table functions by providing each of the parameters that they accept and examining the result. The <code>table_map</code> parameter will be the schema information for the data model that you are developing table functions for. Additionally, a valid DBI connection object should be supplied for the <code>db_connection</code> argument. “Subject Tables” require an integer value for the selected <code>subject_id.</code></p>
<p>When developing your table functions, feel free to <code>select()</code>, <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>, <code>mutate()</code>, or otherwise modify the appearance of the patient data such that it displays how you want it to look on the Chart Review tab. The <code>dplyr</code> package has been declared as an import in the table function skeleton, so many <code>dplyr</code> transformations may be included in your development. To display properly, the table function must eventually <code>collect()</code> the information from the database so that the table will render in ReviewR.</p>
<p>When you are ready to test these table functions within ReviewR, run:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu">golem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/golem/man/document_and_reload.html">document_and_reload</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<p>This will incorporate your newly developed functions into ReviewR so that you can further refine how they display patient information.</p>
<div id="flexibility" class="section level4">
<h4 class="hasAnchor">
<a href="#flexibility" class="anchor"></a>Flexibility</h4>
<p>ReviewR is capable of working with patient databases that may differ <em>slightly</em> from the official specification. For example, in the MIMIC-III specification, demographic information can be found in the ‘PATIENTS’ table (upper case). Using the ReviewR’s <code><a href="../reference/user_table.html">user_table()</a></code> function, it is possible to request the ‘PATIENTS’ table from the connected database, even if the table is stored as ‘patients’ (lower case). Table fields may be requested in a similar fashion, using the <code><a href="../reference/user_field.html">user_field()</a></code> function.</p>
</div>
<div id="all-patients-table" class="section level4">
<h4 class="hasAnchor">
<a href="#all-patients-table" class="anchor"></a>All Patients Table</h4>
<p>The "all patients’ table will be used to render the patients displayed in the ‘Patient Search’ Section of ReviewR. This function must have a very specific name:</p>
<ul>
<li><code>{data-model-name}_table_all_patients</code></li>
</ul>
<p>Additionally, the “all patients” table function must be designed to accept two arguments from ReviewR:</p>
<ul>
<li>
<code>table_map</code>: returned by the data model detection module</li>
<li>
<code>db_connection</code>: which is supplied by the database connection module</li>
</ul>
<p>ReviewR will handle supplying this information, but the table functions must be coded to accept these two arguments.</p>
<p>Using MIMIC-III as an example, demographic information is contained within the ‘PATIENTS’ table. A potential ‘all_patients’ table would be:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">mimic3_table_all_patients</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table_map</span>, <span class="va">db_connection</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">ReviewR</span><span class="fu">::</span><span class="fu"><a href="../reference/user_table.html">user_table</a></span><span class="op">(</span><span class="va">table_map</span>, <span class="va">db_connection</span>, <span class="st">'PATIENTS'</span><span class="op">)</span>
<span class="op">}</span></pre></div>
</div>
<div id="subject-specific-tables" class="section level4">
<h4 class="hasAnchor">
<a href="#subject-specific-tables" class="anchor"></a>Subject Specific Tables</h4>
<p>“Subject Specific” tables will make up the tabs that appear in the Chart Review Section of ReviewR. Each table is filtered to contain information from the subject that has been selected in the Patient Search Section. These functions follow the naming convention as specified below:</p>
<ul>
<li><code>{data-model-name}_table_{table-name}</code></li>
</ul>
<p>These table functions must be designed to accept 3 arguments:</p>
<ul>
<li>
<code>table_map</code>: returned by the data model detection module</li>
<li>
<code>db_connection</code>: which is supplied by the database connection module</li>
<li>
<code>subject_id</code>: The selected patient identifier returned by the navigation module</li>
</ul>
<p>ReviewR will handle supplying this information, but the table functions must be coded to accept these three arguments.</p>
<p>Again, using MIMIC-III as an example, let’s draft a potential ‘ADMISSIONS’ table function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">mimic3_table_admissions</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table_map</span>, <span class="va">db_connection</span>, <span class="va">subject_id</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">ReviewR</span><span class="fu">::</span><span class="fu"><a href="../reference/user_table.html">user_table</a></span><span class="op">(</span><span class="va">table_map</span>, <span class="va">db_connection</span>, <span class="st">'ADMISSIONS'</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/name.html">as.name</a></span><span class="op">(</span><span class="fu">ReviewR</span><span class="fu">::</span><span class="fu"><a href="../reference/user_field.html">user_field</a></span><span class="op">(</span><span class="va">table_map</span>, <span class="st">'ADMISSIONS'</span>,<span class="st">'PATIENT_ID'</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="va">subject_id</span><span class="op">)</span>
<span class="op">}</span></pre></div>
</div>
</div>
<div id="finishing-up" class="section level3">
<h3 class="hasAnchor">
<a href="#finishing-up" class="anchor"></a>Finishing up</h3>
<p>Once you are satisfied with your patient table functions and have sufficiently tested their functionality, run:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/install.html">install</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<p>This will install a new, custom version of the ReviewR package with your newly incorporated data model and supporting table functions.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Laura Wiley, Luke Rasmussen, David Mayer, The Wiley Lab.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
